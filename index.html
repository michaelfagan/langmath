<!DOCTYPE html>
<html>
	<meta charset="utf-8">
	<!-- todo
		sets
			? handle feminine gender for portuguese
			? pictograms (eg one apple, two apples)
			american sign language
			braille (english?)
			Gurmukhi numerals are so similar to indian/devanagari numerals
			? morse code
			don't bother with semaphore
			meta sets (.e.g "1+1" for two and a whole set of squares eg sqrt of 0 1 4 9 16 etc)
			etc
		convert to native app
		functionality
			add in subtraction
			save status
			more gamification? need to research
		more
			add audio output when clicking on numbers where audio representations exist
		colours, themes, transitions, animations
			transition from one question to the next
			animate correct button moving to '?' ?
	-->
	<head>
		<style>
			body {
				font-family: Sans-serif;
				font-size: 5em;
			}
			button {
				font-size: 0.8em;
				margin: 0.2em;
				padding: 0.2em;
			}
			button:not([disabled]):hover, button:not([disabled]):focus {
				cursor: pointer;
				color: white;
				background-color: black;
			}
			button.right, button.wrong {
				color: white;
				background-color: green;
			}
			button.wrong {
				background-color: red;
			}
			#question {
				text-align: center;
				margin: 0.2em 0 0.5em 0;
			}
			#question.right, .right #blank {
				color: green;
				font-weight: bold;
			}
			span {
				border: 0.05em solid black;
				border-radius: 0.2em;
				padding: 0.2em;
			}
			#blank {
				color: #888;
			}
		</style>
	</head>
	<body>

		<p id="question"></p>
		<div id="answers"></div>

		<script>
			var max_num = 2;
			var max_lang = 2;
			var numbers_ordered = true;
			var random = function(max, skew_high) {
				if (typeof skew_high === 'undefined') {
					return Math.floor(Math.random() * (max + 1));
				}
				// skews by rolling twice and picking higher
				return Math.floor(Math.max(Math.random() * (max + 1), Math.random() * (max + 1)));
			};
			var numbers = [
				{
					name: 'Arabic numerals',
					numerals: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
				},
				{
					name: 'English words',
					numerals: ['zero', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen', 'seventeen', 'eighteen', 'nineteen', 'twenty']
				},
				{
					name: 'Chinese numerals',
					numerals: ['零', '一', '二', '三', '四', '五', '六', '七', '八', '九', '十', '十一', '十二', '十三', '十四', '十五', '十六', '十七', '十八', '十九', '二十']
				},
				{
					name: 'Spanish words',
					numerals: ['cero', 'uno', 'dos', 'tres', 'cuatro',  'cinco', 'seis', 'siete', 'ocho', 'nueve', 'diez', 'once', 'doce', 'trece', 'catorce', 'quince', 'dieciséis', 'diecisiete', 'dieciocho', 'diecinueve', 'veinte']
				},
				{
					name: 'Roman numerals',
					numerals: [false, 'I', 'II', 'III', 'IV', 'V', 'VI', 'VII', 'VIII', 'IV', 'X', 'XI', 'XII', 'XIII', 'XIV', 'XV', 'XVI', 'XVII', 'XVIII', 'XIX', 'XX'],
				},
				{
					name: 'Indian numerals',
					numerals: ['०', '१', '२', '३', '४', '५', '६', '७', '८', '९', '१०', '११', '१२', '१३', '१४', '१५', '१६', '१७', '१८', '१९', '२०']
				},
				{
					name: 'Portuguese words',
					numerals: ['zero', 'um', 'dois', 'três', 'quatro', 'cinco', 'seis', 'sete', 'oito', 'nove', 'dez', 'onze', 'doze', 'treze', 'catorze', 'quinze', 'dezasseis', 'dezassete', 'dezoito', 'dezanove', 'vinte']
				},
				{
					name: 'Bengali numerals',
					numerals: ['০', '১', '২', '৪', '৫', '৬', '৭', '৮', '৯', '১০', '১১', '১২', '১৩', '১৪', '১৫', '১৬', '১৭', '১৮', '১৯', '২০']
				},
				{
					name: 'Russian words',
					numerals: ['ноль', 'один', 'два', 'три', 'четыре', 'пять', 'шесть', 'семь', 'восемь', 'девять', 'десять', 'одиннадцать', 'двенадцать', 'тринадцать', 'четырнадцать', 'пятнадцать', 'шестнадцать', 'семнадцать', 'восемнадцать', 'девятнадцать', 'двадцать']
				},
				{
					name: 'German words',
					numerals: [ 'null', 'eins', 'zwei', 'drei', 'vier', 'fünf', 'sechs', 'sieben', 'acht', 'neun', 'zehn', 'elf', 'zwölf', 'dreizehn', 'vierzehn', 'fünfzehn', 'sechzehn', 'siebzehn', 'achtzehn', 'neunzehn', 'zwanzig']
				}
			];
			var equation = document.getElementById('question');
			var answers = document.getElementById('answers');
			var wrong = 0;
			var right_streak = 0;
			var button_for = function(n, answer) {
				return '<button data-correct="' + (n === answer) + '">' + numbers[random(max_lang)].numerals[n] + '</button>';
			};
			var ask = function() {
				if (right_streak === 4) {
					if (numbers_ordered) {
						numbers_ordered = false;
					}
					else if (max_num < 10) {
						max_num +=2;
						numbers_ordered = true;
					}
					else if (max_lang <= numbers.length) {
						max_num = 2;
						numbers_ordered = true;
						max_lang++;
					}
					right_streak = 0;
				}
				var q = [random(max_num, true), random(max_num, true)];
				q.push(q[0] + q[1]);
				var blank = random(2);
				var answer = q[blank];
				equation.classList.remove('right');
				var q_disp = q.map(function(num, i){
					return i === blank ? '<span id="blank">?</span>' : '<span>' + numbers[random(max_lang, true)].numerals[num] + '</span>';
				});
				equation.innerHTML = q_disp[0] + ' + ' + q_disp[1];
				if (random(1)) {
					equation.insertAdjacentHTML('beforeend', ' = ' + q_disp[2]);
				}
				else {
					equation.insertAdjacentHTML('afterbegin', q_disp[2] + ' = ');
				}
				var buttons = [];
				for (var i=0; i<=(max_num*2); i++) {
					buttons.push(button_for(i, answer));
				}
				if (!numbers_ordered) {
					// add duplicate numbers from different sets
					var num_buttons = buttons.length * 1.5;
					while (buttons.length < num_buttons) {
						var button = button_for(random(max_num*2), answer);
						if (buttons.indexOf(button) === -1) {
							buttons.push(button);
						}

					}
					// randomize order
					var buttons_random = [];
					while (buttons.length) {
						var i = random(buttons.length-1);
						buttons_random.push(buttons[i]);
						buttons.splice(i, 1);
					}
					buttons = buttons_random;
				}
				answers.innerHTML = buttons.join('');
			};
			answers.addEventListener('click', function(e){
				if (e.target.tagName.toLowerCase() === 'button') {
					e.target.setAttribute('disabled', 'disabled');
					if (e.target.getAttribute('data-correct') === 'true') {
						e.target.classList.add('right');
						document.getElementById('blank').innerHTML = e.target.textContent;
						if (answers.querySelectorAll("[data-correct='true']:not(:disabled)").length === 0) {
							equation.classList.add('right');
							setTimeout(ask, 1000);
							if (wrong === 0) {
								right_streak++;
							}
							wrong = 0;
						}
					}
					else {
						e.target.classList.add('wrong');
						wrong++;
					}
				}
			});

			ask();
		</script>

	</body>
</html>